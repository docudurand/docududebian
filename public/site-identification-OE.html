<!DOCTYPE html>
<!--site identification OE-->
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Site identification OE</title>

  <style>
    body{
      margin: 0;
      padding: 24px;
      background: #ffffff;
      font-family: Arial, Helvetica, sans-serif;
    }

    table{
      border-collapse: collapse;
      width: 100%;
      margin: 0 auto;
      font-size: 20px;
      background: #ffffff;
    }

    td, th{
      border: 2px solid #333;
      padding: 15px;
      text-align: center;
      vertical-align: middle;
    }

    a{
      color: #0654ba;
      text-decoration: none;
      word-break: break-word;
    }

    a:hover{
      text-decoration: underline;
    }
  </style>
</head>
<body>

<table>
  <thead>
    <tr><th>MARQUE</th><th>LIEN</th><th>NOTE</th></tr>
  </thead>
  <tbody id="siteOeBody"></tbody>
</table>

<script>
(function(){
  const tbody = document.getElementById("siteOeBody");
  async function load(){
    const r = await fetch("/api/util/site-identification-oe", { cache:"no-store" });
    if (!r.ok) throw new Error("HTTP " + r.status);
    return r.json();
  }
  function render(rows){
    tbody.innerHTML = "";
    if (!Array.isArray(rows) || rows.length === 0) {
      tbody.innerHTML = "<tr><td colspan='3' style='padding:14px'>Aucune donn√©e.</td></tr>";
      return;
    }
    rows.forEach(row => {
      const tr = document.createElement("tr");
      const td1 = document.createElement("td");
      td1.textContent = row.marque || "";
      const td2 = document.createElement("td");
      const url = String(row.url || "").trim();
      if (url) {
        const a = document.createElement("a");
        a.href = url;
        a.target = "_blank";
        a.rel = "noopener noreferrer";
        a.textContent = url;
        td2.appendChild(a);
      }
      const td3 = document.createElement("td");
      td3.textContent = row.note || "";
      tr.appendChild(td1);
      tr.appendChild(td2);
      tr.appendChild(td3);
      tbody.appendChild(tr);
    });
  }
  load().then(render).catch(err => {
    tbody.innerHTML = "<tr><td colspan='3' style='padding:14px;color:#842029;font-weight:bold;'>Erreur chargement JSON : " + err.message + "</td></tr>";
  });
})();
</script>

</body>
</html>
